<article>
<mat-card *ngIf=data
          class="section-card"
          id = "diseaseSources"
          (pharosScrollspy)="active('diseaseSources')"
          #diseaseSources>
  <mat-card-content>
    <div *ngIf="loading" class = "loadingIcon" fxLayoutAlign="center center">
      <img class="spinner rotating" src="./assets/images/pharos_spinner.svg">
    </div>
    <div fxLayout="row"
         class="tkrow"
         fxLayoutAlign="start stretch">
      <div fxFlex="95">
        <span class="mat-title"
              [matTooltip] = description
              [matTooltipClass] = "'pharos-tooltip'">
          Disease Associations by Source ({{treeData?.length}})</span>
      </div>
        <div fxFlex="5">
          <pharos-help-panel-trigger [origin] = "'diseaseSources'" [label]="'Disease Sources'"></pharos-help-panel-trigger>
        </div>
      </div>
      <div fxLayout="row" fxLayout.lt-md="column" class ="tkrow" fxLayoutAlign="space-around stretch">
        <div fxFlex="95" class = "disease-tree">
          <mat-paginator
            [pageSize]="10"
            [length]="treeData.length"
            [hidePageSize]="true"
            [showFirstLastButtons] = true
            (page) = paginate($event)
            #treepaginator></mat-paginator>
          <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="disease-tree">
            <!-- This is the tree node template for leaf nodes -->
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
            <ul>
              <li class="mat-tree-node">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                <ncats-property-display [property]="node.name ? node.name : node" [showLabel]="!node.name"></ncats-property-display>
                <span *ngIf = "node.children && node.children.length > 0">({{node.children?.length}})</span>
              </li>
            </ul>
            </mat-tree-node>
            <!-- This is the tree node template for expandable nodes -->
            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
             <ul>
              <li>
                <div class="mat-tree-node">
                  <button mat-icon-button
                          matTreeNodeToggle
                          [attr.aria-label]="'toggle ' + node.name.term">
                    <mat-icon class="mat-icon-rtl-mirror">
                      {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                    </mat-icon>
                  </button>
                  <ncats-property-display [property]="node.name" [showLabel]="false"></ncats-property-display>
                  &nbsp;({{node.children.length}} sources)
                </div>
                <ul [class.disease-tree-invisible]="!treeControl.isExpanded(node)">
                  <ng-container matTreeNodeOutlet></ng-container>
                </ul>
              </li>
             </ul>
            </mat-nested-tree-node>
          </mat-tree>
        </div>
      </div>
      <div fxLayout="row" *ngIf="tinx && tinx.length > 0"
           fxLayout.lt-md="column" fxLayoutAlign="start stretch"
           class="tinx-row">
        <div fxFlex="95">
          <span
            [matTooltip] = "getTooltip('tinx')"
            [matTooltipClass] = "'pharos-tooltip'"
            class="mat-title">Disease Novelty (Tin-x)</span>
        </div>
        <div fxFlex="5">
          <pharos-help-panel-trigger [origin] = "'diseaseSources'" [label]="'Disease Sources'"></pharos-help-panel-trigger>
        </div>
      </div>
        <div fxLayout="row" *ngIf="tinx && tinx.length > 0" fxLayout.lt-md="column" class ="tkrow tinx" fxLayoutAlign="start stretch">
        <div fxFlex="100">
          <pharos-scatter-plot [data]="tinx" [options]="chartOptions" #scatterInstance></pharos-scatter-plot>
    </div>
      </div>
  </mat-card-content>
</mat-card>
