<mat-card *ngIf=data
          class="section-card"
          id = "diseaseRelationships"
          (pharosScrollspy)="active('diseaseRelationships')"
          #diseaseRelationships>
  <mat-card-content>
    <div fxLayout="row"
         fxLayout.lt-md="column"
         class="tkrow"
         fxLayoutAlign="start stretch"
         #development>
      <div fxFlex="95">
        <span class="mat-title"
              [matTooltip] = description
              [matTooltipClass] = "'pharos-tooltip'">
          Disease Associations by Source ({{diseaseSourcesArray?.length}})</span>
      </div>
        <div fxFlex="5">
          <pharos-help-panel-trigger [origin] = "'diseaseSources'" [label]="'Disease Sources'"></pharos-help-panel-trigger>
        </div>
      </div>
      <div fxLayout="row" fxLayout.lt-md="column" class ="tkrow" fxLayoutAlign="space-around stretch">
        <div fxFlex="95" class = "disease-tree">
          <ul >
            <li *ngFor = "let disease of treeData; let expand = false">
             <div class="tree-leaf"><button mat-icon-button (click)="expand = !expand"><mat-icon>
                {{expand ? 'expand_more' : 'chevron_right'}}
              </mat-icon></button>
              <ncats-property-display [property]="disease.disease" [showLabel]="false"></ncats-property-display>&nbsp;({{disease.sources.length}} sources)
              <ul *ngIf="expand" class ="sub-leaf">
                <div class="tree-leaf">
                <li *ngFor = "let source of disease.sources">
                  <button mat-icon-button><mat-icon>chevron_right</mat-icon></button>
                  <ncats-property-display [property]="source.name" [showLabel]="false"></ncats-property-display>&nbsp;: {{source.children.length}}
                </li>
                </div>
              </ul>
             </div>
            </li>
          </ul>

          <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="disease-tree">
            <!-- This is the tree node template for leaf nodes -->
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
              <li class="mat-tree-node">
                <!-- use a disabled button to provide padding for tree leaf -->
                <button mat-icon-button disabled></button>
                {{showNodeData(node)}} <span *ngIf = node.children>({{node.children?.length}})</span>
              </li>
            </mat-tree-node>
            <!-- This is the tree node template for expandable nodes -->
            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
              <li>
                <div class="mat-tree-node">
                  <button mat-icon-button matTreeNodeToggle
                          [attr.aria-label]="'toggle ' + node.name['term'] ? node.name['term'] : node.name">
                    <mat-icon class="mat-icon-rtl-mirror">
                      {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                    </mat-icon>
                  </button>
                  {{node.name['term'] ? node.name['term'] : node.name}} ({{node.children?.length}} sources)
                </div>
                <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                  <ng-container matTreeNodeOutlet></ng-container>
                </ul>
              </li>
            </mat-nested-tree-node>
          </mat-tree>









<!--
    <mat-tab-group (selectedTabChange)="changeTabData($event)" *ngIf = 'diseaseSourcesArray.length > 1; else tableOnly'>
      <mat-tab *ngFor="let source of diseaseSourcesArray" label = "{{source}} ({{getSourceCount(source)}})"  >
        <ng-template matTabContent>
        <pharos-generic-table
          (pageChange)="paginate($event)"
          (sortChange)="sort($event)"
          [pageData]="pageData"
          [data]="tableArr"
          [fieldsConfig] = fieldsData>
        </pharos-generic-table>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
    <ng-template #tableOnly>
      <pharos-generic-table
        (pageChange)="paginate($event)"
        (sortChange)="sort($event)"
        [pageData]="pageData"
        [data]="tableArr"
        [fieldsConfig] = fieldsData>
      </pharos-generic-table>
    </ng-template>-->
        </div>
      </div>
      <div fxLayout="row" *ngIf="tinx && tinx.length > 0"
           fxLayout.lt-md="column" fxLayoutAlign="start stretch"
           class="tinx-row">
        <div fxFlex="95">
          <span
            [matTooltip] = "getTooltip('tinx')"
            [matTooltipClass] = "'pharos-tooltip'"
            class="mat-title">Disease Novelty (Tin-x)</span>
        </div>
        <div fxFlex="5">
          <pharos-help-panel-trigger [origin] = "'diseaseSources'" [label]="'Disease Sources'"></pharos-help-panel-trigger>
        </div>
      </div>
        <div fxLayout="row" *ngIf="tinx && tinx.length > 0" fxLayout.lt-md="column" class ="tkrow tinx" fxLayoutAlign="start stretch">
        <div fxFlex="100">
          <pharos-scatter-plot [data]="tinx" [options]="chartOptions" #scatterInstance></pharos-scatter-plot>
    </div>
      </div>
  </mat-card-content>
</mat-card>
